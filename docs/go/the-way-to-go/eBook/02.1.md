# 2.1 平台与架构

Go语言开发团队开发了适用于以下操作系统的编译器：

- Linux
- FreeBSD
- Mac OS X（也称为Darwin）

目前有2个版本的编译器：Go原生编译器gc和非原生编译器gccgo，这两款编译器都是在类Unix系统下工作。其中，gc版本的编译器已经被移植到Windows平台上，并集成在主要发行版中，你也可以通过安装MinGW从而在Windows平台下使用gcc 编译器。这两个编译器都是以单通道的形式工作。

你可以获取以下平台上的Go 1.4源码和二进制文件：

- Linux 2.6+：amd64、386和arm架构
- Mac OS X(Snow Leopard + Lion)：amd64 和 386 架构
- Windows 2000+：amd64 和 386 架构

对于非常底层的纯Go语言代码或者包而言，在各个操作系统平台上的可移植性是非常强的，只需要将源码拷贝到相应平台上进行编译即可，或者可以使用交叉编译来构建目标平台的应用程序(第2.2 节)。但如果你打算使用cgo或者类似文件监控系统的软件，就需要根据实际情况进行相应地修改了。

1. Go原生编译器gc：

	主要基于Ken Thompson先前在Plan 9操作系统上使用的C工具链。

	Go语言的编译器和链接器都是使用C语言编写并产生本地代码，Go不存在自我引导之类的功能。因此如果使用一个有不同指令集的编译器来构建Go程序，就需要针对操作系统和处理器架构(32位操作系统或64位操作系统)进行区别对待。

	这款编译器使用非分代、无压缩和并行的方式进行编译，它的编译速度要比gccgo更快，产生更好的本地代码，但编译后的程序不能够使用gcc进行链接。

	编译器目前支持以下基于Intel或AMD处理器架构的程序构建。

	![](../images/2.1.gc.jpg?raw=true)

	图2.1 gc 编译器支持的处理器架构

	当你第一次看到这套命名系统的时候你会觉得很奇葩，不过这些命名都是来自于Plan 9项目。

		g = 编译器：将源代码编译为项目代码（程序文本）
		l = 链接器：将项目代码链接到可执行的二进制文件（机器代码）

	（相关的C编译器名称为6c、8c和5c，相关的汇编器名称为6a、8a和5a）

	**标记(Flags)** 是指可以通过命令行设置可选参数来影响编译器或链接器的构建过程或得到一个特殊的目标结果。

	可用的编译器标记如下：
	
		flags:
		-I 针对包的目录搜索
		-d 打印声明信息
		-e 不限制错误打印的个数
		-f 打印栈结构
		-h 发生错误时进入恐慌（panic）状态
		-o 指定输出文件名 // 详见第3.4节
		-S 打印产生的汇编代码
		-V 打印编译器版本 // 详见第2.3节
		-u 禁止使用 unsafe 包中的代码
		-w 打印归类后的语法解析树
		-x 打印 lex tokens

	从Go 1.0.3 版本开始，不再使用8g，8l之类的指令进行程序的构建，取而代之的是统一的`go build`和`go install`等命令，而这些指令会自动调用相关的编译器或链接器。
	
	如果你想获得更深层次的信息，你可以在目录[`$GOROOT/src/cmd`](https://github.com/golang/go/tree/master/src/cmd) 下找到编译器和链接器的源代码。Go 语言本身是由C语言开发的，而不是Go语言(Go 1.5开始自举)。词法分析程序是GNU bison，语法分析程序是名为[`$GOROOT/src/cmd/gc/go.y`](https://github.com/golang/go/blob/master/src%2Fcmd%2Finternal%2Fgc%2Fgo.y)的yacc 文件，它会在同一目录输出`y.tab.{c,h}`文件。如果你想知道更多有关构建过程的信息，你可以在[`$GOROOT/src/make.bash`](https://github.com/golang/go/blob/master/src/make.bash)中找到。

	大部分的目录都包含了名为`doc.go`的文件，这个文件提供了更多详细的信息。

2. gccgo编译器：
	
	一款相对于gc而言更加传统的编译器，使用GCC作为后端。GCC是一款非常流行的GNU编译器，它能够构建基于众多处理器架构的应用程序。编译速度相对gc较慢，但产生的本地代码运行要稍微快一点。它同时也提供一些与C语言之间的互操作性。

	从Go 1版本开始，gc和gccgo 在编译方面都有等价的功能。

3. 文件扩展名与包(package)：

	Go语言源文件的扩展名很显然就是`.go`。

	C文件使用后缀名`.c`，汇编文件使用后缀名`.s`。所有的源代码文件都是通过包(packages)来组织。包含可执行代码的包文件在被压缩后使用扩展名`.a`(AR 文档)。

	Go语言的标准库（第 9.1 节）包文件在被安装后就是使用这种格式的文件。

	**注意** 当你在创建目录时，文件夹名称永远不应该包含空格，而应该使用下划线 "_" 或者其它一般符号代替。

## 链接

- [目录](directory.md)
- 上一章：[语言的主要特性与发展的环境和影响因素](01.2.md)
- 下一节：[Go环境变量](02.2.md)
